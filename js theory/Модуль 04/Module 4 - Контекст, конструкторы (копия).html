<!DOCTYPE html>
<!-- saved from url=(0061)http://fecore.net.ua/javascript/pages/theory/module-04-2.html -->
<html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><meta http-equiv="X-UA-Compatible" content="ie=edge"><title>Module 4</title><link rel="stylesheet" href="Module 4 - Контекст, конструкторы_files/styles.min.css"><script async="" src="Module 4 - Контекст, конструкторы_files/scripts.min.js.Без названия"></script></head><body class="theory-page"><div class="wrapper"><article><header><h1>Модуль 4 - Теория, часть вторая</h1><nav class="table-of-contents" id="main-nav"><ol class="page-nav" id="page-nav"><li><a href="http://fecore.net.ua/javascript/pages/theory/module-04-2.html#context">Контекст исполнения</a></li><li><a href="http://fecore.net.ua/javascript/pages/theory/module-04-2.html#ctx-rules">Правила определения this</a></li><li><a href="http://fecore.net.ua/javascript/pages/theory/module-04-2.html#ctx-binding">Методы функций call/apply/bind</a></li><li><a href="http://fecore.net.ua/javascript/pages/theory/module-04-2.html#constructor-fn">Создание объектов через new</a></li></ol></nav></header><section><h2 id="context">Контекст исполнения</h2><p>Многие разработчики часто путают область видимости и контекст. Можно с уверенностью сказать, что ключевое слово <code>this</code> является одной из самых запутанных частей JavaScript. Многие начинающие разработчики, подставляют <code>this</code> методом научного тыка до тех пор, пока скрипт не сработает.</p><p>Контекст в JavaScript похож на контекст в предложении:</p><ul><li>«Петя бежит быстро, потому что Петя пытается поймать поезд.»</li><li>«Петя бежит быстро, потому что он пытается поймать поезд.»</li></ul><p>Второе предложение звучит лаконичнее. Предметом предложения является Петя, и мы можем сказать, что контекст предложения - это Петя, потому что он в центре внимания в это конкретное время в предложении. Даже местоимение «кто» относится к Пете.</p><p>И точно так же, мы можем иметь объект, который является текущим контекстом исполнения функции.</p><pre class=" language-javascript"><code class=" language-javascript"><span class="token comment">// «Петя бежит быстро, потому что Петя пытается поймать поезд.»</span>
<span class="token keyword keyword-const">const</span> petya <span class="token operator">=</span> <span class="token punctuation">{</span>
  name<span class="token punctuation">:</span> <span class="token string">'Petya'</span><span class="token punctuation">,</span>
  <span class="token function">showName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>petya<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

petya<span class="token punctuation">.</span><span class="token function">showName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>Обращение к свойствам объекта внутри методов, используя имя самого объекта, аналогично использованию "Петя" вместо "он".</p><p>Во-первых, надо знать, что все функции JavaScript имеют свойства, так же как объекты имеют свойства, потому что функции это тоже объекты. И когда функция выполняется, она получает свойство <code>this</code> - переменную со ссылкой на объект, в контексте которого вызывается функция, в которой используется <code>this</code>. <code>this</code> всегда ссылается на объект.</p><p><code>this</code> нам нужен для доступа к методам и свойствам объекта, который вызывает функцию, тем более, что мы не всегда знаем, имя вызывающего объекта.</p><pre class=" language-javascript"><code class=" language-javascript"><span class="token comment">// «Петя бежит быстро, потому что он (this) пытается поймать поезд.»</span>
<span class="token keyword keyword-const">const</span> petya <span class="token operator">=</span> <span class="token punctuation">{</span>
  name<span class="token punctuation">:</span> <span class="token string">'Petya'</span><span class="token punctuation">,</span>
  <span class="token function">showName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword keyword-this">this</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

petya<span class="token punctuation">.</span><span class="token function">showName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></section><section><h2 id="ctx-rules">Правила определения this</h2><p>Необходимо усвоить всего одно правило для определения <code>this</code>: значение <code>this</code>, внутри функции, определятся не в момент создания функции, а в момент ее вызова.</p><p>Значение <code>this</code> определяет то, как вызывается функция. Несмотря на то, что кажется как будто <code>this</code> ссылается на объект внутри которого был определен метод объекта.</p><h3>this в глобальной области видимости</h3><p>В глобальной области видимости, контекст ссылается на объект <code>window</code>, если скрипт не находится в строгом режиме <code>"use strict"</code>.</p><p>Когда мы используем строгий режим, значение <code>this</code>, в глобальной области видимости (в глобальных функциях и анонимных функциях), будет <code>undefined</code>.</p><pre class=" language-javascript"><code class=" language-javascript"><span class="token keyword keyword-function">function</span> <span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword keyword-this">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// window без "use strict" и udefined с "use strict"</span></code></pre><h4>this в методе объекта</h4><p>Если функция была вызвана как метод объекта, то контекст будет ссылаться на объект, частью которого является метод.</p><pre class=" language-javascript"><code class=" language-javascript"><span class="token keyword keyword-const">const</span> petya <span class="token operator">=</span> <span class="token punctuation">{</span>
  name<span class="token punctuation">:</span> <span class="token string">'Petya'</span><span class="token punctuation">,</span>
  <span class="token function">showThis</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword keyword-this">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">showName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword keyword-this">this</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

petya<span class="token punctuation">.</span><span class="token function">showThis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// {name: "Petya", showThis: ƒ, showName: ƒ}</span>
petya<span class="token punctuation">.</span><span class="token function">showName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 'Petya'</span></code></pre><p>Более сложный пример:</p><ul><li>сначала создадим функцию в глобальной области видимости, и вызовем ее.</li><li>после чего присвоим ее в свойство объекта и вызовем как метод этого объекта.</li></ul><pre class=" language-javascript"><code class=" language-javascript"><span class="token keyword keyword-function">function</span> <span class="token function">showName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'this in showName: '</span><span class="token punctuation">,</span> <span class="token keyword keyword-this">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"this.name: "</span><span class="token punctuation">,</span> <span class="token keyword keyword-this">this</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// Вызываем в глоабльном контексте</span>
  <span class="token function">showName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// this in showName: Window</span>
  <span class="token comment">// this.name:</span>

  <span class="token keyword keyword-const">const</span> user <span class="token operator">=</span> <span class="token punctuation">{</span> name<span class="token punctuation">:</span> <span class="token string">"Mango"</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token comment">// Записываем ссылку на функцию в свойство объекта</span>
  <span class="token comment">// Обратите внимание, что это не вызов - нет ()</span>
  user<span class="token punctuation">.</span>show <span class="token operator">=</span> showName<span class="token punctuation">;</span>

  <span class="token comment">// Вызываем функцию в контексте объекта</span>
  <span class="token comment">// this будет указывать на текущий объект, в контексте</span>
  <span class="token comment">// которого осуществляется вызов, а не на глобальный объект.</span>
  user<span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// this in showName: {name: "Mango", show: ƒ}</span>
  <span class="token comment">// this.name:  Mango</span></code></pre><h3>this в стрелочных функциях</h3><p>Для стрелочных функций в JavaScript сделано исключение. У них отсутсвует свой <code>this</code>, и поэтому внутри стрелочных функций <code>this</code> определяется местом создания, а не местом вызова.</p><pre class=" language-javascript"><code class=" language-javascript"><span class="token keyword keyword-const">const</span> <span class="token function-variable function">showName</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'In showName: '</span><span class="token punctuation">,</span> <span class="token keyword keyword-this">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">showName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// In showName: window</span>

<span class="token keyword keyword-const">const</span> user <span class="token operator">=</span> <span class="token punctuation">{</span> name<span class="token punctuation">:</span> <span class="token string">'Mango'</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
user<span class="token punctuation">.</span>show <span class="token operator">=</span> showName<span class="token punctuation">;</span>

user<span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// In showName: window</span></code></pre><h4>use strict</h4><p>Стрелочные функции игнорируют наличие строгого режима.</p><pre class=" language-javascript"><code class=" language-javascript"><span class="token string">"use strict"</span><span class="token punctuation">;</span>
<span class="token keyword keyword-const">const</span> <span class="token function-variable function">fn</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword keyword-this">this</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span> <span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// window</span></code></pre><h4>this в локальной области видимости</h4><pre class=" language-javascript"><code class=" language-javascript"><span class="token keyword keyword-const">const</span> hotel <span class="token operator">=</span> <span class="token punctuation">{</span>
  showThis<span class="token punctuation">:</span> <span class="token keyword keyword-function">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword keyword-const">const</span> <span class="token function-variable function">fn</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword keyword-this">this</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span> <span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

hotel<span class="token punctuation">.</span><span class="token function">showThis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// {showThis: ƒ} </span></code></pre><p>Будьте внимательны при использовании стрелочных функций как методов объекта.</p><pre class=" language-javascript"><code class=" language-javascript"><span class="token keyword keyword-const">const</span> hotel <span class="token operator">=</span> <span class="token punctuation">{</span>
  name<span class="token punctuation">:</span> <span class="token string">"Resort Hotel"</span><span class="token punctuation">,</span>
  showName<span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'this: '</span><span class="token punctuation">,</span> <span class="token keyword keyword-this">this</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// this внутри метода созданного через стрелочную функцию</span>
<span class="token comment">// будет всегда ссылаться на тот контекст в котором</span>
<span class="token comment">// был создан сам объект, то есть на внешний контекст</span>
hotel<span class="token punctuation">.</span><span class="token function">showName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// this:  window или undefined</span></code></pre><h3>this функциях обратного вызова</h3><p>Когда мы передаем метод, который использует <code>this</code>, в качестве параметра, который будет использоваться как функция обратного вызова, мы получим проблему. Решение этой проблемы рассматривается в следующей секции.</p><pre class=" language-javascript"><code class=" language-javascript"><span class="token keyword keyword-const">const</span> hotel <span class="token operator">=</span> <span class="token punctuation">{</span>
  name<span class="token punctuation">:</span> <span class="token string">"Resort Hotel"</span><span class="token punctuation">,</span>
  <span class="token function">showThis</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword keyword-this">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword keyword-const">const</span> <span class="token function-variable function">fn</span> <span class="token operator">=</span> <span class="token keyword keyword-function">function</span> <span class="token punctuation">(</span>callback<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// callback это ссылка на функцию showThis объекта user.</span>
  <span class="token comment">// Ее вызов происходит в глобальном контексте</span>
  <span class="token comment">// Соответственно this не будет ссылаться на hotel</span>
  <span class="token function">callback</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token function">fn</span><span class="token punctuation">(</span>hotel<span class="token punctuation">.</span>showThis<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// window</span></code></pre></section><section><h2 id="ctx-binding">Методы функций call/apply/bind</h2><p>Присвоение функции в качестве метода объекта может показаться хорошей идеей. Но стоит ли хранить подобные методы? Дублирование уже существующих функций в виде методов объекта будет занимать ресурсы, не принося никаких заметных выгод. Можно удалять метод после использования с помощью ключевого слова <code>delete</code>.</p><pre class=" language-javascript"><code class=" language-javascript"><span class="token comment">// функция</span>
<span class="token keyword keyword-const">const</span> <span class="token function-variable function">greet</span> <span class="token operator">=</span> <span class="token keyword keyword-function">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword keyword-return">return</span> <span class="token template-string"><span class="token string">`Wellcome to </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword keyword-this">this</span><span class="token punctuation">.</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">!`</span></span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// объект</span>
<span class="token keyword keyword-const">const</span> hotel <span class="token operator">=</span> <span class="token punctuation">{</span> name<span class="token punctuation">:</span> <span class="token string">"Resort Hotel"</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// присвоение объекту метода</span>
hotel<span class="token punctuation">.</span>wellcome <span class="token operator">=</span> greet<span class="token punctuation">;</span>

<span class="token comment">// метод работает с this объекта</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span> hotel<span class="token punctuation">.</span><span class="token function">wellcome</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// "Wellcome to Resort Hotel!"</span>

<span class="token comment">// удаление метода из объекта</span>
<span class="token keyword keyword-delete">delete</span> hotel<span class="token punctuation">.</span>wellcome<span class="token punctuation">;</span>

<span class="token comment">// проверяем наличие свойства(метода) у объекта</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"wellcome"</span> <span class="token keyword keyword-in">in</span> hotel<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// false</span></code></pre><p>Теперь представьте что у вас 150 отелей и для каждого необходимо выполнить ту же самую операцию... каждый раз когда необходимо поприветствовать нового гостя. Нам как минимум хочется сразу вынести этот общий код в функцию, которая будет получать функцию и объект, свойству которого ее присвоить, а после вызова удалить.</p><p>JavaScript предлагает более элегантное, готовое решение - "метод взаймы". С помощью методов <code>call</code> и <code>apply</code> можно повторить последовательность с присвоением объекту метода, выполнением этого метода и последующим удалением с помощью всего лишь одной команды.</p><pre class=" language-javascript"><code class=" language-javascript"><span class="token keyword keyword-const">const</span> <span class="token function-variable function">greet</span> <span class="token operator">=</span> <span class="token keyword keyword-function">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword keyword-return">return</span> <span class="token template-string"><span class="token string">`Wellcome to </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword keyword-this">this</span><span class="token punctuation">.</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> hotel!`</span></span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword keyword-const">const</span> hotel <span class="token operator">=</span> <span class="token punctuation">{</span> name<span class="token punctuation">:</span> <span class="token string">"Resort Hotel"</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span> hello<span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>hotel<span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// "Wellcome to Resort Hotel!"</span></code></pre><h3>call и аргументы</h3><p>Запомнить правило использования <code>call</code> довольно легко: метод <code>call</code> вызовет функцию <code>fn</code> передав ее <code>this</code> ссылку на объект <code>obj</code>, а также аргументы <code>arg1, arg2, ...</code>.</p><p><code>fn.call(obj, arg1, arg2, ...)</code></p><pre class=" language-javascript"><code class=" language-javascript"><span class="token keyword keyword-const">const</span> <span class="token function-variable function">greet</span> <span class="token operator">=</span> <span class="token keyword keyword-function">function</span> <span class="token punctuation">(</span>guest<span class="token punctuation">,</span> stars<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword keyword-return">return</span> <span class="token template-string"><span class="token string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>guest<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">, welcome to </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>stars<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">-star </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword keyword-this">this</span><span class="token punctuation">.</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">!`</span></span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword keyword-const">const</span> hotel <span class="token operator">=</span> <span class="token punctuation">{</span> name<span class="token punctuation">:</span> <span class="token string">"Resort Hotel"</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword keyword-const">const</span> motel <span class="token operator">=</span> <span class="token punctuation">{</span> name<span class="token punctuation">:</span> <span class="token string">"Sunlight Motel"</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span> greet<span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>hotel<span class="token punctuation">,</span> <span class="token string">"Mango"</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// "Mango, wellcome to 5-star Resort Hotel!"</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span> greet<span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>motel<span class="token punctuation">,</span> <span class="token string">"Poly"</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// "Poly, wellcome to 4-star Sunlight Motel!"</span></code></pre><h3>apply и аргументы</h3><p>Метод <code>apply</code> полный аналог метода <code>call</code> за исключением того, что синтаксис вызова аргументов требует не перечисление а массив.</p><p><code>fn.call(obj, [arg1, arg2, ...])</code></p><pre class=" language-javascript"><code class=" language-javascript"><span class="token keyword keyword-const">const</span> <span class="token function-variable function">greet</span> <span class="token operator">=</span> <span class="token keyword keyword-function">function</span> <span class="token punctuation">(</span>guest<span class="token punctuation">,</span> stars<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword keyword-return">return</span> <span class="token template-string"><span class="token string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>guest<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">, welcome to </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>stars<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">-star </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword keyword-this">this</span><span class="token punctuation">.</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">!`</span></span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword keyword-const">const</span> hotel <span class="token operator">=</span> <span class="token punctuation">{</span> name<span class="token punctuation">:</span> <span class="token string">"Resort Hotel"</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword keyword-const">const</span> motel <span class="token operator">=</span> <span class="token punctuation">{</span> name<span class="token punctuation">:</span> <span class="token string">"Sunlight Motel"</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span> greet<span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>hotel<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">"Mango"</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// "Mango, wellcome to 5-star Resort Hotel!"</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span> greet<span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>motel<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">"Poly"</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// "Poly, wellcome to 4-star Sunlight Motel!"</span></code></pre><h3>bind</h3><p>Мы рассмотрели случаи, когда необходимо вызвать функцию с другим контекстом, для этого используются методы <code>call</code> и <code>apply</code>. Но в случае функции обратного вызова, когда необходимо не вызвать функцию на месте, а передать ссылку на эту функцию, причем с привязанным контекстом, <code>call</code> и <code>apply</code> не подходят. Метод <code>bind</code> позволяет решить эту задачу.</p><p><code>const boundFn = fn.bind(obj, arg1, arg2, ...)</code></p><p>Метод <code>bind</code> создает копию функции <code>fn</code> с привязанным контекстом <code>obj</code> и аргументами <code>arg1, arg2, ...</code>, после чего возвращает ее как результат своей работы. В результате мы получаем копию функции с привязанным контекстом, которую мы можем передать куда угодно и вызвать когда угодно.</p><pre class=" language-javascript"><code class=" language-javascript"><span class="token keyword keyword-const">const</span> <span class="token function-variable function">greet</span> <span class="token operator">=</span> <span class="token keyword keyword-function">function</span> <span class="token punctuation">(</span>guest<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword keyword-return">return</span> <span class="token template-string"><span class="token string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>guest<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">, welcome to </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword keyword-this">this</span><span class="token punctuation">.</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">!`</span></span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword keyword-const">const</span> hotel <span class="token operator">=</span> <span class="token punctuation">{</span> name<span class="token punctuation">:</span> <span class="token string">"Resort Hotel"</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword keyword-const">const</span> hotelGreeter <span class="token operator">=</span> greet<span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span>hotel<span class="token punctuation">,</span> <span class="token string">"Mango"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">hotelGreeter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// "Mango, wellcome to Resort Hotel!"</span></code></pre><p>Чаще всегда метод <code>bind</code> используется для привязки контекста при передаче функций обратного вызова. Возьмем проблемный пример из предыдущей секции.</p><pre class=" language-javascript"><code class=" language-javascript"><span class="token keyword keyword-const">const</span> hotel <span class="token operator">=</span> <span class="token punctuation">{</span>
  name<span class="token punctuation">:</span> <span class="token string">"Resort Hotel"</span><span class="token punctuation">,</span>
  <span class="token function">showThis</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword keyword-this">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword keyword-const">const</span> <span class="token function-variable function">fn</span> <span class="token operator">=</span> <span class="token keyword keyword-function">function</span> <span class="token punctuation">(</span>callback<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// callback это ссылка на функцию showThis объекта user.</span>
  <span class="token comment">// Ее вызов происходит в глобальном контексте</span>
  <span class="token comment">// Соответственно this не будет ссылаться на hotel</span>
  <span class="token function">callback</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token function">fn</span><span class="token punctuation">(</span>hotel<span class="token punctuation">.</span>showThis<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// window</span></code></pre><p>Задачу привязки контеста мы теперь можем решить используя метод <code>bind</code>, передав функцией обратного вызова копию метода с привязанным контекстом.</p><pre class=" language-javascript"><code class=" language-javascript"><span class="token keyword keyword-const">const</span> hotel <span class="token operator">=</span> <span class="token punctuation">{</span>
  name<span class="token punctuation">:</span> <span class="token string">"Resort Hotel"</span><span class="token punctuation">,</span>
  <span class="token function">showThis</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword keyword-this">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword keyword-const">const</span> <span class="token function-variable function">fn</span> <span class="token operator">=</span> <span class="token keyword keyword-function">function</span> <span class="token punctuation">(</span>callback<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">callback</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// передаем копию метода showThis</span>
<span class="token comment">// с контекстом привязанным к hotel</span>
<span class="token function">fn</span><span class="token punctuation">(</span>hotel<span class="token punctuation">.</span>showThis<span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span>hotel<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// {name: "Resort Hotel", showThis: ƒ}</span></code></pre></section><section><h2 id="constructor-fn">Создание объектов через new</h2><p>Обычный синтаксис литера объекта <code>{}</code> позволяет создать один объект. Но зачастую нужно создать много однотипных объектов. Для этого используют <strong>функции-конструкторы</strong>, вызывая их при помощи специального оператора <code>new</code>.</p><h3>Конструктор</h3><p><strong>Конструктор</strong> - это обычная функция к которой применили оператор <code>new</code>. В результате это приводит к созданию в области <code>Heap</code> объекта, а переменной присваивается ссылка на этот объект.</p><p>Технически, любая функция может быть использована как конструктор. То есть, любую функцию можно вызвать при помощи <code>new</code>. Как-то особым образом указывать, что она конструктор – не надо.</p><p>Чтобы отличить обычную функцию от конструктора, принято называть конструкторы с большой буквы, а в самом названии отражать тип создаваемого объекта. Вы уже сталкивались с конструкторами: <code>Object</code>, <code>Array</code>, <code>Number</code> и другие.</p><p>Процесс создания объекта через вызов конструтора происходит следующим образом:</p><ul><li>Создаётся новый пустой объект.</li><li>Ключевое слово <code>this</code> внутри конструктора получает ссылку на этот объект.</li><li>Конструктор вызывается. Как правило, он модифицирует <code>this</code> (созданный объект), добавляет методы, свойства.</li><li>Возвращается <code>this</code>.</li></ul><pre class=" language-javascript"><code class=" language-javascript"><span class="token keyword keyword-function">function</span> <span class="token function">Hotel</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> stars<span class="token punctuation">,</span> capacity<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword keyword-this">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
  <span class="token keyword keyword-this">this</span><span class="token punctuation">.</span>stars <span class="token operator">=</span> stars<span class="token punctuation">;</span>
  <span class="token keyword keyword-this">this</span><span class="token punctuation">.</span>capacity <span class="token operator">=</span> capacity<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// В результате вызова :</span>
<span class="token keyword keyword-const">const</span> hotel <span class="token operator">=</span> <span class="token keyword keyword-new">new</span> <span class="token class-name">Hotel</span><span class="token punctuation">(</span><span class="token string">"Resort Hotel"</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// получаем такой объект</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span> hotel <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// Hotel {name: "Resort Hotel", stars: 5, capacity: 100}</span></code></pre><p>Если визуализировать происходящее, то при вызове <code>new Hotel</code> происходит что-то в таком духе (первая и последняя строка – это то, что делает интерпретатор):</p><pre class=" language-javascript"><code class=" language-javascript"><span class="token keyword keyword-function">function</span> <span class="token function">Hotel</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> stars<span class="token punctuation">,</span> capacity<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// this = {};</span>

  <span class="token comment">// в this пишем свойства и методы</span>
  <span class="token keyword keyword-this">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
  <span class="token keyword keyword-this">this</span><span class="token punctuation">.</span>stars <span class="token operator">=</span> stars<span class="token punctuation">;</span>
  <span class="token keyword keyword-this">this</span><span class="token punctuation">.</span>capacity <span class="token operator">=</span> capacity<span class="token punctuation">;</span>

  <span class="token comment">// return this;</span>
<span class="token punctuation">}</span></code></pre><p>Теперь многократными вызовами <code>new Hotel</code> с разными параметрами мы можем создать любое количество объектов. Использование конструкторов удобно при созданнии множества объектов с одним набором свойств имеющих разные значения. Поэтому такую функцию и называют конструктором – она предназначена для конструирования объектов.</p><pre class=" language-javascript"><code class=" language-javascript"><span class="token keyword keyword-function">function</span> <span class="token function">Hotel</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> stars<span class="token punctuation">,</span> capacity<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword keyword-this">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
  <span class="token keyword keyword-this">this</span><span class="token punctuation">.</span>stars <span class="token operator">=</span> stars<span class="token punctuation">;</span>
  <span class="token keyword keyword-this">this</span><span class="token punctuation">.</span>capacity <span class="token operator">=</span> capacity<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword keyword-const">const</span> hotel <span class="token operator">=</span> <span class="token keyword keyword-new">new</span> <span class="token class-name">Hotel</span><span class="token punctuation">(</span><span class="token string">"Resort Hotel"</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span> hotel <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// Hotel {name: "Resort Hotel", stars: 5, capacity: 100}</span>

<span class="token keyword keyword-const">const</span> motel <span class="token operator">=</span> <span class="token keyword keyword-new">new</span> <span class="token class-name">Hotel</span><span class="token punctuation">(</span><span class="token string">"Sunlight Motel"</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">300</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span> motel <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// Hotel {name: "Sunlight Motel", stars: 4, capacity: 300}</span></code></pre><h4>Создание методов в конструкторе</h4><p>Использование функций для создания объекта дает большую гибкость. Можно передавать конструктору параметры, определяющие как его создавать, и он будет «клепать» объекты заданным образом.</p><p>Добавим метод в создаваемый объект. Например, <code>new Hotel(name)</code> создает объект с заданным значением свойства <code>name</code> и методом <code>showName</code>.</p><pre class=" language-javascript"><code class=" language-javascript"><span class="token keyword keyword-function">function</span> <span class="token function">Hotel</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword keyword-this">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>

  <span class="token keyword keyword-this">this</span><span class="token punctuation">.</span><span class="token function-variable function">showName</span> <span class="token operator">=</span> <span class="token keyword keyword-function">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span> <span class="token template-string"><span class="token string">`Hotel name is </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword keyword-this">this</span><span class="token punctuation">.</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword keyword-const">const</span> hotel <span class="token operator">=</span> <span class="token keyword keyword-new">new</span> <span class="token class-name">Hotel</span><span class="token punctuation">(</span><span class="token string">"Sunrise Hotel"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span> hotel <span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Hotel {name: "Sunrise Hotel", showName: ƒ}</span>
hotel<span class="token punctuation">.</span><span class="token function">showName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Hotel name is Sunrise Hotel</span></code></pre><div class="note"><p>В этом разделе небыло упоминания о записи методов конструктора в прототип, так как эта тема выходит за рамки данного модуля и рассматривается дальше в курсе. На этом этапе, нам важно просто уметь создавать объекты по шаблону и понимать принцип работы функций-конструкторов.</p></div><h4>Локальные переменные</h4><p>В конструкторе бывает удобно объявить вспомогательные локальные переменные и вложенные функции, которые будут видны только внутри.</p><pre class=" language-javascript"><code class=" language-javascript"><span class="token keyword keyword-function">function</span> <span class="token function">Hotel</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword keyword-const">const</span> message <span class="token operator">=</span> <span class="token string">"Hotel name is"</span><span class="token punctuation">;</span>
  <span class="token keyword keyword-this">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
  <span class="token keyword keyword-this">this</span><span class="token punctuation">.</span><span class="token function-variable function">showName</span> <span class="token operator">=</span> <span class="token keyword keyword-function">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span> <span class="token template-string"><span class="token string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>message<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword keyword-this">this</span><span class="token punctuation">.</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword keyword-const">const</span> hotel <span class="token operator">=</span> <span class="token keyword keyword-new">new</span> <span class="token class-name">Hotel</span><span class="token punctuation">(</span><span class="token string">"Sunrise Hotel"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span> hotel <span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Hotel {name: "Sunrise Hotel", showName: ƒ}</span>
hotel<span class="token punctuation">.</span><span class="token function">showName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Hotel name is Sunrise Hotel</span></code></pre><h3>Управляем магазином</h3><p>Представьте, у нас есть магазин. В магазине есть два менеджера, занимающихся продажей товаров. И вы решаете написать приложение для организации их работы. Для каждого менеджера создаётся отдельный объект:</p><pre class=" language-javascript"><code class=" language-javascript"><span class="token keyword keyword-const">const</span> mango <span class="token operator">=</span> <span class="token punctuation">{</span>
  name<span class="token punctuation">:</span> <span class="token string">'Mango'</span><span class="token punctuation">,</span>
  sales<span class="token punctuation">:</span> <span class="token number">5</span><span class="token punctuation">,</span>
  <span class="token function">sell</span><span class="token punctuation">(</span>product<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword keyword-this">this</span><span class="token punctuation">.</span>sales <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword keyword-return">return</span> <span class="token template-string"><span class="token string">`Manager </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword keyword-this">this</span><span class="token punctuation">.</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> sold </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>product<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">.`</span></span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>mango<span class="token punctuation">.</span>sales<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 5</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>mango<span class="token punctuation">.</span><span class="token function">sell</span><span class="token punctuation">(</span><span class="token string">'TV'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Manager Mango sold TV</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>mango<span class="token punctuation">.</span><span class="token function">sell</span><span class="token punctuation">(</span><span class="token string">'Microwave'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// Manager Mango sold Microwave</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>mango<span class="token punctuation">.</span>sales<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 7</span>

<span class="token keyword keyword-const">const</span> poly <span class="token operator">=</span> <span class="token punctuation">{</span>
  name<span class="token punctuation">:</span> <span class="token string">'Poly'</span><span class="token punctuation">,</span>
  sales<span class="token punctuation">:</span> <span class="token number">10</span><span class="token punctuation">,</span>
  <span class="token function">sell</span><span class="token punctuation">(</span>product<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword keyword-this">this</span><span class="token punctuation">.</span>sales <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword keyword-return">return</span> <span class="token template-string"><span class="token string">`Manager </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword keyword-this">this</span><span class="token punctuation">.</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> sold </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>product<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">.`</span></span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>poly<span class="token punctuation">.</span>sales<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 10</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>poly<span class="token punctuation">.</span><span class="token function">sell</span><span class="token punctuation">(</span><span class="token string">'TV'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Manager Poly sold TV</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>poly<span class="token punctuation">.</span><span class="token function">sell</span><span class="token punctuation">(</span><span class="token string">'Microwave'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// Manager Poly sold Microwave</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>poly<span class="token punctuation">.</span>sales<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 12</span></code></pre><p>Это было просто и всё работает хорошо. Представьте, что будет, когда наш магазин вырастет и пополнится парой сотен менеджеров, для каждого из которых будет необходимо создать отдельный метод. А если и методов будет много? Очевидно, что создавать объекты подобным способом — не самая лучшая затея.</p><p>К счастью мы знаем о функциях-конструкторах.</p><pre class=" language-javascript"><code class=" language-javascript"><span class="token keyword keyword-const">const</span> <span class="token function-variable function">Manager</span> <span class="token operator">=</span> <span class="token keyword keyword-function">function</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">"manager"</span><span class="token punctuation">,</span> sales <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword keyword-this">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
  <span class="token keyword keyword-this">this</span><span class="token punctuation">.</span>sales <span class="token operator">=</span> sales<span class="token punctuation">;</span>
  <span class="token keyword keyword-this">this</span><span class="token punctuation">.</span><span class="token function-variable function">sell</span> <span class="token operator">=</span> <span class="token keyword keyword-function">function</span><span class="token punctuation">(</span>product<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword keyword-this">this</span><span class="token punctuation">.</span>sales <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword keyword-return">return</span> <span class="token template-string"><span class="token string">`Manager </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword keyword-this">this</span><span class="token punctuation">.</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> sold </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>product<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">.`</span></span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword keyword-const">const</span> mango <span class="token operator">=</span> <span class="token keyword keyword-new">new</span> <span class="token class-name">Manager</span><span class="token punctuation">(</span><span class="token string">'Mango'</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>mango<span class="token punctuation">.</span>sales<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 5</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>mango<span class="token punctuation">.</span><span class="token function">sell</span><span class="token punctuation">(</span><span class="token string">'TV'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Manager Mango sold TV</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>mango<span class="token punctuation">.</span><span class="token function">sell</span><span class="token punctuation">(</span><span class="token string">'Microwave'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// Manager Mango sold Microwave</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>mango<span class="token punctuation">.</span>sales<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 7</span>

<span class="token keyword keyword-const">const</span> poly <span class="token operator">=</span> <span class="token keyword keyword-new">new</span> <span class="token class-name">Manager</span><span class="token punctuation">(</span><span class="token string">'Poly'</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>poly<span class="token punctuation">.</span>sales<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 10</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>poly<span class="token punctuation">.</span><span class="token function">sell</span><span class="token punctuation">(</span><span class="token string">'TV'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Manager Poly sold TV</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>poly<span class="token punctuation">.</span><span class="token function">sell</span><span class="token punctuation">(</span><span class="token string">'Microwave'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// Manager Poly sold Microwave</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>poly<span class="token punctuation">.</span>sales<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 12</span></code></pre><p>Теперь нам не страшно любое количество менеджеров и наше программное обеспечение для управления магазином готово покорить мир!</p><div class="note"><p>Это не финальная версия магазина, в последующих модулях мы значительно расширим тему функций-конструкторов и потимизируем хранение методов конструктора.</p></div></section></article><a href="http://fecore.net.ua/javascript/pages/theory/module-04-2.html#main-nav" class="to-page-nav"></a></div></body></html>