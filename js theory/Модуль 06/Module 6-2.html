<!DOCTYPE html>
<!-- saved from url=(0061)http://fecore.net.ua/javascript/pages/theory/module-06-2.html -->
<html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><meta http-equiv="X-UA-Compatible" content="ie=edge"><title>Module 6</title><link rel="stylesheet" href="./Module 6-2_files/styles.min.css"><script async="" src="./Module 6-2_files/scripts.min.js.Без названия"></script></head><body class="theory-page"><div class="wrapper"><article><header><nav class="table-of-contents" id="main-nav"><ol class="page-nav" id="page-nav"><li><a href="http://fecore.net.ua/javascript/pages/theory/module-06-2.html#cls-basics">ES6 классы</a></li><li><a href="http://fecore.net.ua/javascript/pages/theory/module-06-2.html#inheritance">Наследование</a></li><li><a href="http://fecore.net.ua/javascript/pages/theory/module-06-2.html#extras">Дополнительные материалы</a></li></ol></nav></header><section><h2 id="cls-basics">ES6 классы</h2><p>JavaScript является пожалуй единственным массовым языком программирования с наследованием, основанным не на классах, а на прототипах. Огромное число разработчиков, владеющих техникой использования классов, постоянно пытались переделать язык JavaScript под свои умения, а главное, под имеющиеся наработки в этой области.</p><p>В ES6 сделали шаг навстречу и ввели класс похожий на таковой в языках Java, C# и т.п. Поскольку поведение классов легко реализовать на основе прототипов, то введенный в ES6 класс имеет отличия от простой имитации класса на основе прототипа. Поэтому сравнение классов с "синтаксическим сахаром" несколько преувеличено. Как мы увидим позже, классы созданы прежде всего для более безопасного программирования, исключающего появления части ошибок времени выполнения.</p><h3>Отличие класса от прототипа</h3><p>Прототип это объект, имеющий собственные свойства и методы. Класс это описание объекта - перечисление свойств и методов которые должны быть у объекта созданного на основе класса. Класс принято сравнивать с чертежом, по которому будет создан реальный объект, например чертеж здания это класс, а дом на основе этого чертежа - объект. В JavaScript класс больше всего напоминает функция-конструктор.</p><h3>Определение класса</h3><p><strong>Класс</strong> - это удобный способ для задания конструктора вместе с прототипом.</p><p>Преимущества использования классов:</p><ul><li>Объявление класса не поднимается, в отличии от объявления функции.</li><li>Весь код внутри класса выполняется в строгом режиме.</li><li>Все методы являются неперечислимыми.</li><li>У всех методов класса отсутствует внутренний метод <code>[[Construct]]</code>, что означает появление ошибки при попытке использовать эти методы с оператором <code>new</code>.</li><li>Вызов конструктора класса без оператора <code>new</code> вызовет ошибку.</li></ul><p>Определение класса в JavaScript просто благодаря ключевому слову <code>class</code>. Предположим, мы запустили отель и хотим, чтобы объект JavaScript представлял каждого гостя.</p><pre class=" language-javascript"><code class=" language-javascript"><span class="token comment">//class declaration</span>
<span class="token keyword keyword-class">class</span> <span class="token class-name">Guest</span> <span class="token punctuation">{</span>
  <span class="token comment">//...</span>
<span class="token punctuation">}</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword keyword-typeof">typeof</span> Guest<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// "function"</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>Guest<span class="token punctuation">.</span>prototype<span class="token punctuation">)</span> <span class="token comment">// {constructor: ƒ}</span>

<span class="token keyword keyword-const">const</span> guest <span class="token operator">=</span> <span class="token keyword keyword-new">new</span> <span class="token class-name">Guest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>guest<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Guest {}</span></code></pre><p>Как строить класс, зависит от того, что вам нужно для этого класса. В нашем случае, класс представляет собой гостя отеля, поэтому мы добавим туда поля для имени, количества дней проживания и номера комнаты.</p><p>Класс использует аналог функции-конструктора - метод с названием <code>constructor</code>. Это особый метод, он должен присутствовать в объявлении класса обязательно. Назначение конструктора - создавать <strong>собственные свойства экземпляра</strong> класса (т.е. объекта).</p><p>Функция <code>constructor</code> запускается при создании <code>new Guest</code>, остальные методы записываются в <code>Guest.prototype</code>.</p><p>Свойство класса <code>prototype</code> доступно только для чтения, т.е. это свойство нельзя изменить. В классе должен быть только один конструктор, иначе будет <code>SyntaxError</code>.</p><pre class=" language-javascript"><code class=" language-javascript"><span class="token keyword keyword-class">class</span> <span class="token class-name">Guest</span> <span class="token punctuation">{</span>
  <span class="token comment">// аналог функции-конструктора</span>
  <span class="token function">constructor</span> <span class="token punctuation">(</span>name<span class="token punctuation">,</span> days<span class="token punctuation">,</span> roomNumber<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword keyword-this">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
    <span class="token keyword keyword-this">this</span><span class="token punctuation">.</span>days <span class="token operator">=</span> days<span class="token punctuation">;</span>
    <span class="token keyword keyword-this">this</span><span class="token punctuation">.</span>roomNumber <span class="token operator">=</span> roomNumber<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// аналог Guest.prototype.getFullInfo</span>
  <span class="token function">getFullInfo</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`
      Guest </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword keyword-this">this</span><span class="token punctuation">.</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">
      Will stay for </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword keyword-this">this</span><span class="token punctuation">.</span>days<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> more days
      In room number </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword keyword-this">this</span><span class="token punctuation">.</span>roomNumber<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">
    `</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword keyword-const">const</span> mango <span class="token operator">=</span> <span class="token keyword keyword-new">new</span> <span class="token class-name">Guest</span><span class="token punctuation">(</span><span class="token string">'Mango'</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">26</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

mango<span class="token punctuation">.</span><span class="token function">getFullInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// Guest Mango</span>
<span class="token comment">// Will stay for 7 more days</span>
<span class="token comment">// In room number 26</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>mango <span class="token keyword keyword-instanceof">instanceof</span> <span class="token class-name">Guest</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>mango <span class="token keyword keyword-instanceof">instanceof</span> <span class="token class-name">Object</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true</span></code></pre><p>Если вы заметили, мы определили функцию <code>getFullInfo</code>, которая просто возвращает строку, описывающую гостя. Функции определенный таким образом называться <strong>методами класса</strong> и доступны всем экземплярам через <code>prototype</code>.</p><h3>Геттеры и сеттеры</h3><p>Собственные свойства метода желательно хранить в <code>constructor</code>. Но существует и другой вариант - разместить в теле класса методы <code>set</code> и <code>get</code>. Эти методы используют особый синтаксис. А при их вызове в объекте после имени объекта следует написать только имя геттера или сеттера без вызова функции - т.е. без круглых скобок.</p><pre class=" language-javascript"><code class=" language-javascript"><span class="token keyword keyword-class">class</span> <span class="token class-name">Guest</span> <span class="token punctuation">{</span>
  <span class="token comment">// собственные свойства класса желателно размещать в конструкткоре</span>
  <span class="token function">constructor</span> <span class="token punctuation">(</span>name<span class="token punctuation">,</span> days<span class="token punctuation">,</span> roomNumber<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword keyword-this">this</span><span class="token punctuation">.</span>_name <span class="token operator">=</span> name<span class="token punctuation">;</span>
    <span class="token keyword keyword-this">this</span><span class="token punctuation">.</span>_days <span class="token operator">=</span> days<span class="token punctuation">;</span>
    <span class="token keyword keyword-this">this</span><span class="token punctuation">.</span>_roomNumber <span class="token operator">=</span> roomNumber<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// но есть возможноть размещать вне конструктора</span>
  <span class="token keyword keyword-get">get</span> <span class="token function">name</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword keyword-return">return</span> <span class="token keyword keyword-this">this</span><span class="token punctuation">.</span>_name<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword keyword-set">set</span> <span class="token function">name</span> <span class="token punctuation">(</span>value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword keyword-this">this</span><span class="token punctuation">.</span>_name <span class="token operator">=</span> value<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword keyword-const">const</span> mango <span class="token operator">=</span> <span class="token keyword keyword-new">new</span> <span class="token class-name">Guest</span><span class="token punctuation">(</span><span class="token string">'Mango'</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">26</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// обращение к get и set не требует вызова - т.е. без ()</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span> mango<span class="token punctuation">.</span>name <span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Mango</span>

mango<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">"Mango the Fluffy"</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span> mango<span class="token punctuation">.</span>name <span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Mango the Fluffy</span></code></pre><p>Обратите внимание - имя <strong>геттера</strong> и <strong>сеттера</strong> не может совпадать с именем поля будущего экземпляра. Если в примере выше заменить <code>this._name</code> на <code>this.name</code>, то будет переполнение стека вызовов.</p><h3>Статические свойства и методы</h3><p>Можно создавать собственные свойства класса и собственные методы класса для вызова по имени класса, без создания объекта. Такие свойства и методы называют <strong>статическими</strong>. Для их создания в классе перед свойством или методом нужно добавить служебное слово <code>static</code>.</p><div class="note"><p>Конструктор класса тоже метод, но его нельзя делать статическим, это вызовет ошибку.</p></div><pre class=" language-javascript"><code class=" language-javascript"><span class="token comment">// Класс со статическими свойствами и методами</span>
<span class="token keyword keyword-class">class</span> <span class="token class-name">Calc</span> <span class="token punctuation">{</span>
  <span class="token comment">// класс-калькулятор для двух аргументов</span>
  <span class="token function">constructor</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span>

  <span class="token comment">// метод как замена свойству</span>
  <span class="token keyword keyword-static">static</span> <span class="token keyword keyword-get">get</span> <span class="token function">PI</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword keyword-return">return</span> <span class="token number">3.14</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// статический метод +</span>
  <span class="token keyword keyword-static">static</span> <span class="token function">add</span> <span class="token punctuation">(</span><span class="token operator">...</span>args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword keyword-return">return</span> args<span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span>acc<span class="token punctuation">,</span> next<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> acc <span class="token operator">+</span> next<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// статический метод *</span>
  <span class="token keyword keyword-static">static</span> <span class="token function">mult</span> <span class="token punctuation">(</span><span class="token operator">...</span>args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword keyword-return">return</span> args<span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span>acc<span class="token punctuation">,</span> next<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> acc <span class="token operator">*</span> next<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>Calc<span class="token punctuation">.</span>PI<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment">// 3.14</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>Calc<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 9</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>Calc<span class="token punctuation">.</span><span class="token function">mult</span><span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 144</span></code></pre><p>В концепцию классов JavaScript не вошли «приватные» и «защищённые» свойства. То есть, все свойства и методы класса технически доступны снаружи. Возможно, они появятся в будущих редакциях стандарта.</p></section><section><h2 id="inheritance">Наследование</h2><p>JavaScript позволяет реализовать наследование классов. Это означает, что мы можем создавать новые классы, которые наследуют все от другого класса, но при этом добавляют уникальную информацию для себя.</p><pre class=" language-javascript"><code class=" language-javascript"><span class="token keyword keyword-class">class</span> <span class="token class-name">Child</span> <span class="token keyword keyword-extends">extends</span> <span class="token class-name">Parent</span> <span class="token punctuation">{</span>
  <span class="token comment">// ...</span>
<span class="token punctuation">}</span></code></pre><p>Созданим базовый класс-родитель <code>Animal</code>, от которого класс <code>Dog</code> будет наследовать.</p><pre class=" language-javascript"><code class=" language-javascript"><span class="token keyword keyword-class">class</span> <span class="token class-name">Animal</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword keyword-this">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function">move</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`I, </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword keyword-this">this</span><span class="token punctuation">.</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">, am moving!`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword keyword-class">class</span> <span class="token class-name">Dog</span> <span class="token keyword keyword-extends">extends</span> <span class="token class-name">Animal</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> breed<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// вызвать конструктор Animal с аргументом name</span>
    <span class="token keyword keyword-super">super</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword keyword-this">this</span><span class="token punctuation">.</span>breed <span class="token operator">=</span> breed<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function">bark</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'woof!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function">moveAndMakeSound</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword keyword-super">super</span><span class="token punctuation">.</span><span class="token function">move</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword keyword-this">this</span><span class="token punctuation">.</span><span class="token function">bark</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword keyword-const">const</span> dog <span class="token operator">=</span> <span class="token keyword keyword-new">new</span> <span class="token class-name">Dog</span><span class="token punctuation">(</span><span class="token string">'Mango'</span><span class="token punctuation">,</span> <span class="token string">'shepherd'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

dog<span class="token punctuation">.</span><span class="token function">move</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// I, Mango, am moving!</span>
dog<span class="token punctuation">.</span><span class="token function">bark</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// woof!</span>
dog<span class="token punctuation">.</span><span class="token function">moveAndMakeSound</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// I, Mango, am moving! woof!</span></code></pre><p>Ключевое слово <code>extends</code> указывает на родительский объект, чьи свойства будут унаследованы. При наследовании через <code>extends</code> формируется стандартная цепочка прототипов: методы <code>Dog</code> находятся в <code>Dog.prototype</code>, методы <code>Animal</code> – в <code>Animal.prototype</code>, и они связаны через <code>__proto__</code>.</p><p>Ключевое слово <code>super</code> в конструкторе вызывает конструктор родительского класса.</p><ul><li><code>super</code> должно быть вызвано до <strong>первого обращения к ключевому слову <code>this</code> </strong>в теле конструктора (иначе - ошибка)</li><li><code>super</code> можно вызывать в классе, содержащем <code>extends</code> на родительский класс, иначе - ошибка</li><li><code>super</code> можно не использовать только если конструктор возвращает объект</li></ul><p>Конструктор <code>constructor</code> родителя наследуется автоматически. То есть, если в потомке не указан свой <code>constructor</code>, то используется родительский. Если же у потомка свой <code>constructor</code>, то, чтобы в нём вызвать конструктор родителя – используется синтаксис <code>super()</code> с аргументами для <code>constructor</code> родителя.</p><ul><li>Вызвать конструктор родителя можно только изнутри конструктора потомка. В частности, <code>super()</code> нельзя вызвать из произвольного метода.</li><li>В конструкторе потомка мы обязаны вызвать <code>super()</code> до обращения к this. До вызова super не существует <code>this</code>, так как по спецификации в этом случае именно <code>super</code> инициализирует <code>this</code>.</li><li>При наследовании вызов конструктора родителя осуществляется через <code>super(...args)</code>, вызов родительских методов – через <code>super.method(...args)</code>.</li></ul></section><section><h2 id="extras">Дополнительные материалы</h2><p>Мы познакомились с большинством основ создания и использования классов. Для более глубокого знакомства рекомендуем разобрать статьи по ссылкам.</p><ul><li><a href="https://googlechrome.github.io/samples/classes-es6/index.html" target="_blank">Примеры использования классов от Google</a></li><li><a href="http://2ality.com/2015/02/es6-classes-final.html" target="_blank">Dr. Axel Rauschmayer - Classes in ECMAScript 6</a></li><li><a href="http://exploringjs.com/es6/ch_classes.html" target="_blank">Dr. Axel Rauschmayer - Exploring ES6, classes</a></li></ul></section></article><a href="http://fecore.net.ua/javascript/pages/theory/module-06-2.html#main-nav" class="to-page-nav"></a></div></body></html>